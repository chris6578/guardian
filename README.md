# Guardian
![GitHub license](https://img.shields.io/github/license/mathieu-bour/guardian?style=flat-square)
![Packagist Version](https://img.shields.io/packagist/v/mathieu-bour/guardian?style=flat-square)
![Packagist](https://img.shields.io/packagist/dt/mathieu-bour/guardian?style=flat-square)
![GitHub issues](https://img.shields.io/github/issues/mathieu-bour/guardian?style=flat-square)
![GitHub pull requests](https://img.shields.io/github/issues-pr/mathieu-bour/guardian?style=flat-square)
![Codecov](https://img.shields.io/codecov/c/gh/mathieu-bour/guardian?style=flat-square)
![Scrutinizer code quality](https://img.shields.io/scrutinizer/quality/g/mathieu-bour/guardian?style=flat-square)

Highly configurable JSON Web Token implementation for Laravel and Lumen.

Guardian exposes an additional authentication `guardian` driver, which can be used like the standard `session` or `token` drivers.

Guardian follows the [Semantic Versioning specification](https://semver.org).

:heavy_exclamation_mark: **Until version 1.0.0, the `master` branch should not be considered as stable.** :heavy_exclamation_mark:


## Motivations
Our company based its back-end on the Lumen Framework, and we had to choose a stateless identification and authentication method.
We chose to use the JSON Web Tokens which combine security and ease.
While some libraries exist like [tymondesigns/jwt-auth](https://github.com/tymondesigns/jwt-auth) or [laravel/passport](https://github.com/laravel/passport), they did not fit our requirements.

We finally decided to develop our own JWT library for Lumen, which was later ported to Laravel and shared open-source.


## Acknowledgements
- [Laura Bannier](https://www.linkedin.com/in/laura-bannier/) for her English review
- JWT cryptography implementation by [`web-token`](https://github.com/web-token/jwt-framework)
- Benchmarks run using [PHPBench](https://github.com/phpbench/phpbench)
- Documentation generated by [VuePress](https://vuepress.vuejs.org/)
- Tests run using [PHPUnit](https://phpunit.de/) and [Mockery](https://github.com/mockery/mockery)


## Prerequisites
- PHP >= 7.2
- openssl PHP extension
- sodium PHP extension
- Laravel/Lumen 6 or 7


## Installation
Simply add Guardian to your project dependencies.

```bash
composer require mathieu-bour/guardian
```

Depending on the [algorithm](https://mathieu-bour.github.io/guardian/reference/configuration.html#key) you want to use, install an additional library:

| Algorithm | Library                                   |
|-----------|-------------------------------------------|
| ECDSA     | `web-token/jwt-signature-algorithm-ecdsa` |
| EdDSA     | `web-token/jwt-signature-algorithm-eddsa` |
| HMAC      | `web-token/jwt-signature-algorithm-hmac`  |
| RSA       | `web-token/jwt-signature-algorithm-rsa`   |

If you do not know which algorithm to choose, we recommend `ECDSA` with the `ES512` algorithm and the `P-521` curve.

### Laravel
Publish the default Guardian configuration:

```bash
php artisan vendor:publish --provider="Windy\Guardian\GuardianServiceProvider"
```

### Lumen
Copy the default Guardian configuration from `vendor/mathieu-bour/guardian/config/guardian.php` to `config/guardian.php`.
Then, add the provider to your `bootstrap/app.php` and load the configuration with:

```php
$app->configure('guardian');

$app->register(Windy\Guardian\GuardianServiceProvider::class);
```

If you want to use the `Guardian` Facade, ensure that the application is loaded with the Facades in your `bootstrap/app.php`.

```php
$app->withFacades();
```


## Next steps
- Learn more about [JWT](https://mathieu-bour.github.io/guardian/reference/jwt)
- Read the [configuration](https://mathieu-bour.github.io/guardian/reference/configuration) reference
- Read our [tutorial on users authentication](https://mathieu-bour.github.io/guardian/case-studies/authentication)


## Alternatives
We humbly refer here to the alternatives to Guardian that we found interesting.

### [laravel/passport](https://github.com/laravel/passport)
Passport is the official Laravel library which supports JWT authentication.

> Laravel makes API authentication a breeze using Laravel Passport, which provides a full OAuth2 server implementation for your Laravel application in a matter of minutes.

### [tymondesigns/jwt-auth](https://github.com/tymondesigns/jwt-auth)
jwt-auth is a very serious alternative to Guardian which provides a higher-level API, such as authenticating users directly from the request credentials via a Facade.
jwt-auth also provides a way to blacklist the generated tokens where Guardian let the implementation to the developer.
If you are looking for a simpler way to use JWT, we highly recommend you to take a look to this library!
